<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Profissional | Green Jobs Brasil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-green: #2ECC71;
            --dark-green: #27AE60;
            --light-green: #A9DFBF;
            --success-green: #28A745;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #E8F5E9 0%, #F1F8E9 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }
        
        .header {
            background: linear-gradient(135deg, var(--dark-green) 0%, var(--primary-green) 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .form-container {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .section-title {
            color: var(--dark-green);
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light-green);
        }
        
        .ods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin: 1rem 0;
        }
        
        .ods-checkbox {
            display: none;
        }
        
        .ods-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .ods-checkbox:checked + .ods-label {
            background: var(--primary-green);
            color: white;
            border-color: var(--dark-green);
        }
        
        .skill-tag {
            display: inline-block;
            background: var(--light-green);
            color: var(--dark-green);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            margin: 0.25rem;
            font-size: 0.9rem;
        }
        
        .skill-tag .remove-skill {
            margin-left: 0.5rem;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-green {
            background: var(--primary-green);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-green:hover {
            background: var(--dark-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .progress-bar {
            background: var(--primary-green);
        }
        
        .alert-success {
            background: var(--light-green);
            color: var(--dark-green);
            border: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="mb-0"><i class="fas fa-user-tie"></i> Cadastro de Profissional</h1>
                    <p class="mb-0 mt-2">Fa√ßa parte da maior plataforma de empregos verdes do Brasil</p>
                </div>
                <a href="/" class="btn btn-light">
                    <i class="fas fa-home"></i> Voltar
                </a>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Progresso do cadastro -->
        <div class="mb-4">
            <div class="d-flex justify-content-between mb-2">
                <span><strong>Progresso do Cadastro:</strong></span>
                <span id="progress-text">0%</span>
            </div>
            <div class="progress" style="height: 10px;">
                <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
            </div>
        </div>

        <form id="cadastroForm">
            <!-- Se√ß√£o 1: Dados Pessoais -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-user"></i> Dados Pessoais</h3>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Nome Completo *</label>
                        <input type="text" class="form-control" name="nome_completo" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Email *</label>
                        <input type="email" class="form-control" name="email" required>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Telefone</label>
                        <input type="tel" class="form-control" name="telefone" placeholder="(11) 99999-9999">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">LinkedIn</label>
                        <input type="url" class="form-control" name="linkedin_url" placeholder="https://linkedin.com/in/seu-perfil">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Portf√≥lio / Site</label>
                        <input type="url" class="form-control" name="portfolio_url">
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 2: Localiza√ß√£o -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> Localiza√ß√£o e Mobilidade</h3>
                
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Estado (UF)</label>
                        <select class="form-select" name="localizacao_uf">
                            <option value="">Selecione</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amap√°</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Cear√°</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Esp√≠rito Santo</option>
                            <option value="GO">Goi√°s</option>
                            <option value="MA">Maranh√£o</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Par√°</option>
                            <option value="PB">Para√≠ba</option>
                            <option value="PR">Paran√°</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piau√≠</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rond√¥nia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">S√£o Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Cidade</label>
                        <input type="text" class="form-control" name="localizacao_cidade">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Disponibilidade</label>
                        <select class="form-select" name="disponibilidade">
                            <option value="imediata">Imediata</option>
                            <option value="30dias">30 dias</option>
                            <option value="60dias">60 dias</option>
                            <option value="90dias">90 dias</option>
                            <option value="indefinida">A combinar</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="aceita_remoto" id="aceita_remoto" checked>
                            <label class="form-check-label" for="aceita_remoto">
                                Aceito trabalho remoto
                            </label>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="disponivel_mudanca" id="disponivel_mudanca">
                            <label class="form-check-label" for="disponivel_mudanca">
                                Dispon√≠vel para mudan√ßa de cidade
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 3: ODS de Interesse -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-globe"></i> Objetivos de Desenvolvimento Sustent√°vel (ODS)</h3>
                <p class="text-muted">Selecione os ODS com os quais voc√™ tem interesse ou experi√™ncia:</p>
                
                <div class="ods-grid">
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="7" id="ods7">
                        <label class="ods-label" for="ods7">
                            <span>‚ö°</span>
                            <span>7. Energia Limpa</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="8" id="ods8">
                        <label class="ods-label" for="ods8">
                            <span>üíº</span>
                            <span>8. Trabalho Decente</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="9" id="ods9">
                        <label class="ods-label" for="ods9">
                            <span>üè≠</span>
                            <span>9. Ind√∫stria</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="11" id="ods11">
                        <label class="ods-label" for="ods11">
                            <span>üèôÔ∏è</span>
                            <span>11. Cidades</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="12" id="ods12">
                        <label class="ods-label" for="ods12">
                            <span>‚ôªÔ∏è</span>
                            <span>12. Consumo Resp.</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="13" id="ods13">
                        <label class="ods-label" for="ods13">
                            <span>üåç</span>
                            <span>13. A√ß√£o Clim√°tica</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="14" id="ods14">
                        <label class="ods-label" for="ods14">
                            <span>üåä</span>
                            <span>14. Vida na √Ågua</span>
                        </label>
                    </div>
                    <div>
                        <input type="checkbox" class="ods-checkbox" name="ods" value="15" id="ods15">
                        <label class="ods-label" for="ods15">
                            <span>üå≥</span>
                            <span>15. Vida Terrestre</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 4: Experi√™ncia Profissional -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-briefcase"></i> Experi√™ncia Profissional</h3>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Anos de Experi√™ncia Total</label>
                        <input type="number" class="form-control" name="anos_experiencia_total" min="0" max="50">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Anos de Experi√™ncia em ESG/Sustentabilidade *</label>
                        <input type="number" class="form-control" name="anos_experiencia_esg" min="0" max="50" required>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Cargo Atual</label>
                        <input type="text" class="form-control" name="cargo_atual">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Empresa Atual</label>
                        <input type="text" class="form-control" name="empresa_atual">
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">N√≠vel Profissional Desejado *</label>
                    <select class="form-select" name="nivel_desejado" required>
                        <option value="">Selecione</option>
                        <option value="junior">J√∫nior</option>
                        <option value="pleno">Pleno</option>
                        <option value="senior">S√™nior</option>
                        <option value="especialista">Especialista</option>
                        <option value="gerencial">Gerencial</option>
                    </select>
                </div>
            </div>

            <!-- Se√ß√£o 5: Forma√ß√£o -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-graduation-cap"></i> Forma√ß√£o Acad√™mica</h3>
                
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">N√≠vel de Forma√ß√£o</label>
                        <select class="form-select" name="formacao_nivel">
                            <option value="">Selecione</option>
                            <option value="medio">Ensino M√©dio</option>
                            <option value="tecnico">T√©cnico</option>
                            <option value="superior">Superior</option>
                            <option value="pos-graduacao">P√≥s-gradua√ß√£o</option>
                            <option value="mestrado">Mestrado</option>
                            <option value="doutorado">Doutorado</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">√Årea de Forma√ß√£o</label>
                        <input type="text" class="form-control" name="formacao_area" placeholder="ex: Engenharia Ambiental">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Institui√ß√£o</label>
                        <input type="text" class="form-control" name="instituicao">
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 6: Habilidades ESG -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-lightbulb"></i> Habilidades e Compet√™ncias ESG</h3>
                
                <div class="mb-3">
                    <label class="form-label">Adicionar Habilidades</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="skillInput" placeholder="Ex: ISO 14001, GRI, Carbon Footprint...">
                        <button type="button" class="btn btn-green" onclick="addSkill()">
                            <i class="fas fa-plus"></i> Adicionar
                        </button>
                    </div>
                    <small class="text-muted">Digite e clique em "Adicionar" para cada habilidade</small>
                </div>
                
                <div id="skillsContainer" class="mb-3">
                    <!-- Skills ser√£o adicionadas aqui -->
                </div>
                
                <div class="mb-3">
                    <label class="form-label">√Åreas de Interesse</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="areaInput" placeholder="Ex: Energia Renov√°vel, Gest√£o de Res√≠duos...">
                        <button type="button" class="btn btn-green" onclick="addArea()">
                            <i class="fas fa-plus"></i> Adicionar
                        </button>
                    </div>
                </div>
                
                <div id="areasContainer" class="mb-3">
                    <!-- √Åreas ser√£o adicionadas aqui -->
                </div>
            </div>

            <!-- Se√ß√£o 7: Prefer√™ncias de Trabalho -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-sliders-h"></i> Prefer√™ncias de Trabalho</h3>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Tipo de Contrata√ß√£o</label>
                        <div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="tipo_contratacao" value="CLT" id="clt">
                                <label class="form-check-label" for="clt">CLT</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="tipo_contratacao" value="PJ" id="pj">
                                <label class="form-check-label" for="pj">PJ</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="tipo_contratacao" value="Estagio" id="estagio">
                                <label class="form-check-label" for="estagio">Est√°gio</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Pretens√£o Salarial (R$)</label>
                        <div class="row">
                            <div class="col-6">
                                <input type="number" class="form-control" name="pretensao_salarial_min" placeholder="M√≠nimo">
                            </div>
                            <div class="col-6">
                                <input type="number" class="form-control" name="pretensao_salarial_max" placeholder="M√°ximo">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 8: Sobre Voc√™ -->
            <div class="form-container">
                <h3 class="section-title"><i class="fas fa-pen"></i> Sobre Voc√™</h3>
                
                <div class="mb-3">
                    <label class="form-label">Resumo Profissional *</label>
                    <textarea class="form-control" name="resumo_profissional" rows="4" 
                        placeholder="Descreva brevemente sua trajet√≥ria profissional e experi√™ncias em ESG/Sustentabilidade..." required></textarea>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Motiva√ß√£o para Trabalhar com ESG</label>
                    <textarea class="form-control" name="motivacao_esg" rows="3" 
                        placeholder="Por que voc√™ quer trabalhar com sustentabilidade e ESG?"></textarea>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Link do Curr√≠culo (PDF/Drive/Dropbox)</label>
                    <input type="url" class="form-control" name="curriculo_url" placeholder="https://...">
                </div>
            </div>

            <!-- Bot√µes de A√ß√£o -->
            <div class="form-container text-center">
                <button type="submit" class="btn btn-green btn-lg">
                    <i class="fas fa-check"></i> Concluir Cadastro
                </button>
                <a href="/profissionais" class="btn btn-secondary btn-lg ms-2">
                    <i class="fas fa-times"></i> Cancelar
                </a>
            </div>
        </form>

        <!-- Modal de Sucesso -->
        <div class="modal fade" id="successModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-success text-white">
                        <h5 class="modal-title"><i class="fas fa-check-circle"></i> Cadastro Conclu√≠do!</h5>
                    </div>
                    <div class="modal-body text-center">
                        <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
                        <h4 class="mt-3">Bem-vindo(a) √† Green Jobs Brasil!</h4>
                        <p>Seu perfil foi cadastrado com sucesso. Agora voc√™ pode:</p>
                        <ul class="text-start">
                            <li>Buscar vagas verdes compat√≠veis com seu perfil</li>
                            <li>Receber recomenda√ß√µes personalizadas</li>
                            <li>Ser encontrado por empresas sustent√°veis</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <a href="/profissionais" class="btn btn-secondary">Ver Profissionais</a>
                        <a href="/vagas" class="btn btn-green">Buscar Vagas</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Arrays para armazenar skills e √°reas
        let skills = [];
        let areas = [];

        // Adicionar habilidade
        function addSkill() {
            const input = document.getElementById('skillInput');
            const skill = input.value.trim();
            
            if (skill && !skills.includes(skill)) {
                skills.push(skill);
                renderSkills();
                input.value = '';
                updateProgress();
            }
        }

        // Renderizar habilidades
        function renderSkills() {
            const container = document.getElementById('skillsContainer');
            container.innerHTML = skills.map((skill, index) => `
                <span class="skill-tag">
                    ${skill}
                    <span class="remove-skill" onclick="removeSkill(${index})">√ó</span>
                </span>
            `).join('');
        }

        // Remover habilidade
        function removeSkill(index) {
            skills.splice(index, 1);
            renderSkills();
            updateProgress();
        }

        // Adicionar √°rea
        function addArea() {
            const input = document.getElementById('areaInput');
            const area = input.value.trim();
            
            if (area && !areas.includes(area)) {
                areas.push(area);
                renderAreas();
                input.value = '';
                updateProgress();
            }
        }

        // Renderizar √°reas
        function renderAreas() {
            const container = document.getElementById('areasContainer');
            container.innerHTML = areas.map((area, index) => `
                <span class="skill-tag">
                    ${area}
                    <span class="remove-skill" onclick="removeArea(${index})">√ó</span>
                </span>
            `).join('');
        }

        // Remover √°rea
        function removeArea(index) {
            areas.splice(index, 1);
            renderAreas();
            updateProgress();
        }

        // Atualizar barra de progresso
        function updateProgress() {
            const form = document.getElementById('cadastroForm');
            const inputs = form.querySelectorAll('input[required], textarea[required], select[required]');
            const ods = form.querySelectorAll('input[name="ods"]:checked');
            
            let filled = 0;
            let total = inputs.length + 2; // +2 para ODS e habilidades
            
            // Contar campos obrigat√≥rios preenchidos
            inputs.forEach(input => {
                if (input.value.trim()) filled++;
            });
            
            // Contar ODS
            if (ods.length > 0) filled++;
            
            // Contar habilidades
            if (skills.length > 0) filled++;
            
            const progress = Math.round((filled / total) * 100);
            document.getElementById('progress-bar').style.width = progress + '%';
            document.getElementById('progress-text').textContent = progress + '%';
        }

        // Monitorar mudan√ßas no formul√°rio
        document.getElementById('cadastroForm').addEventListener('input', updateProgress);
        document.querySelectorAll('input[name="ods"]').forEach(checkbox => {
            checkbox.addEventListener('change', updateProgress);
        });

        // Permitir Enter para adicionar skills
        document.getElementById('skillInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addSkill();
            }
        });

        document.getElementById('areaInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addArea();
            }
        });

        // Submit do formul√°rio
        document.getElementById('cadastroForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Coletar dados do formul√°rio
            const formData = new FormData(this);
            const data = {};
            
            // Campos simples
            formData.forEach((value, key) => {
                if (key !== 'ods' && key !== 'tipo_contratacao') {
                    data[key] = value;
                }
            });
            
            // Arrays
            data.ods_interesse = Array.from(document.querySelectorAll('input[name="ods"]:checked'))
                .map(cb => parseInt(cb.value));
            
            data.tipo_contratacao_desejado = Array.from(document.querySelectorAll('input[name="tipo_contratacao"]:checked'))
                .map(cb => cb.value);
            
            data.habilidades_esg = skills;
            data.areas_interesse = areas;
            
            // Checkboxes
            data.aceita_remoto = document.getElementById('aceita_remoto').checked;
            data.disponivel_mudanca = document.getElementById('disponivel_mudanca').checked;
            
            // Converter n√∫meros
            if (data.anos_experiencia_total) data.anos_experiencia_total = parseInt(data.anos_experiencia_total);
            if (data.anos_experiencia_esg) data.anos_experiencia_esg = parseInt(data.anos_experiencia_esg);
            if (data.pretensao_salarial_min) data.pretensao_salarial_min = parseFloat(data.pretensao_salarial_min);
            if (data.pretensao_salarial_max) data.pretensao_salarial_max = parseFloat(data.pretensao_salarial_max);
            
            // ODS experi√™ncia (vazio por enquanto, pode ser expandido)
            data.ods_experiencia = {};
            data.certificacoes = [];
            
            try {
                const response = await fetch('/api/profissionais/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('Profissional cadastrado:', result);
                    
                    // Mostrar modal de sucesso
                    const modal = new bootstrap.Modal(document.getElementById('successModal'));
                    modal.show();
                } else {
                    const error = await response.json();
                    alert('Erro ao cadastrar: ' + (error.detail || 'Erro desconhecido'));
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao cadastrar profissional. Tente novamente.');
            }
        });

        // Inicializar progresso
        updateProgress();
    </script>
</body>
</html>
